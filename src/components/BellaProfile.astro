---
interface Props {
  about: string;
  birthday: string;
  breed: string;
  favoriteThings: string;
  story: string;
  photos?: string[];
}

const { about, birthday, breed, favoriteThings, story, photos = [] } = Astro.props;

// Calculate age from birthday
function calculateAge(birthdayStr: string): string {
  const birthday = new Date(birthdayStr);
  const today = new Date();
  let age = today.getFullYear() - birthday.getFullYear();
  const monthDiff = today.getMonth() - birthday.getMonth();

  // Adjust if birthday hasn't occurred yet this year
  if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthday.getDate())) {
    age--;
  }

  return age > 1 ? `${age} years` : `${age} year`;
}

const age = calculateAge(birthday);
---

<div class="bella-profile">
  <!-- Hero Section -->
  <div class="hero-section">
    <div class="hero-image">
      {photos && photos.length > 0 ? (
        <img
          src={`/images/${photos[0]}`}
          alt="Bella"
          class="hero-photo"
        />
      ) : (
        <span class="text-8xl">üêï</span>
      )}
    </div>
    <div class="hero-content">
      <h3 class="bella-title">
        <span class="title-bracket">[</span>
        Meet Bella
        <span class="title-bracket">]</span>
      </h3>
      <p class="about-text">{about}</p>
    </div>
  </div>

  <!-- Stats Section -->
  <div class="stats-section">
    <div class="stat-card">
      <div class="stat-label">Age</div>
      <div class="stat-value">{age}</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Breed</div>
      <div class="stat-value">{breed}</div>
    </div>
    <div class="stat-card full-width">
      <div class="stat-label">Favorite Things</div>
      <div class="stat-value">{favoriteThings}</div>
    </div>
  </div>

  <!-- Story Section -->
  <div class="story-section">
    <h4 class="section-title">
      <span class="title-bracket">[</span>
      Our Story
      <span class="title-bracket">]</span>
    </h4>
    <p class="story-text">{story}</p>

    {photos && photos.length > 0 && (
      <div class="photo-grid">
        {photos.map((photo) => (
          <div class="photo-container">
            <img
              src={`/images/${photo}`}
              alt="Bella"
              class="bella-photo"
              loading="lazy"
            />
          </div>
        ))}
      </div>
    )}
  </div>
</div>

<style>
  .bella-profile {
    max-width: 800px;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    gap: 3rem;
  }

  .hero-section {
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 2rem;
    align-items: center;
    padding: 2rem;
    background: var(--color-bg-secondary);
    border: 2px solid var(--color-border);
    border-radius: 12px;
  }

  .hero-image {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--color-accent-bg), var(--color-accent-bg-hover));
    border: 4px solid var(--color-accent);
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 0 30px var(--color-glow);
    overflow: hidden;
  }

  .hero-photo {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .bella-title {
    font-family: var(--font-display);
    font-size: 2rem;
    font-weight: 900;
    color: var(--color-text);
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .title-bracket {
    color: var(--color-accent);
  }

  .about-text {
    font-family: var(--font-mono);
    font-size: 1rem;
    line-height: 1.7;
    color: var(--color-text-secondary);
  }

  .stats-section {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
  }

  .stat-card {
    background: var(--color-bg-secondary);
    border: 2px solid var(--color-border);
    border-radius: 8px;
    padding: 1.5rem;
    transition: all 0.3s ease;
  }

  .stat-card.full-width {
    grid-column: 1 / -1;
  }

  .stat-card:hover {
    border-color: var(--color-accent);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px var(--color-glow);
  }

  .stat-label {
    font-family: var(--font-mono);
    font-size: 0.75rem;
    color: var(--color-text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 0.5rem;
  }

  .stat-value {
    font-family: var(--font-mono);
    font-size: 1.125rem;
    color: var(--color-accent);
    font-weight: 700;
  }

  .section-title {
    font-family: var(--font-display);
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--color-text);
    margin-bottom: 1.5rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .story-text {
    font-family: var(--font-mono);
    font-size: 1rem;
    line-height: 1.8;
    color: var(--color-text-secondary);
    padding: 1.5rem;
    background: var(--color-bg-secondary);
    border-left: 4px solid var(--color-accent);
    border-radius: 4px;
    margin-bottom: 2rem;
  }

  .photo-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 1rem;
  }

  .photo-container {
    aspect-ratio: 1;
    border-radius: 8px;
    overflow: hidden;
    border: 2px solid var(--color-border);
    transition: all 0.3s ease;
    background: var(--color-bg-secondary);
  }

  .photo-container:hover {
    border-color: var(--color-accent);
    transform: scale(1.05);
    box-shadow: 0 0 20px var(--color-glow);
  }

  .bella-photo {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
  }

  .photo-container:hover .bella-photo {
    transform: scale(1.1);
  }
</style>
